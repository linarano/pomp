<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.pompeu.admin.support.dao.AskDao">

  <resultMap type="ask" id="askMap">
    <id column="ask_no" property="no"/>
    <result column="member_no" property="memberNo"/>
    <result column="ask_content" property="askContent"/>
    <result column="answer_content" property="answerContent"/>
    <result column="register_date" property="registerDate"/>
    <result column="answer_date" property="answerDate"/>
  </resultMap>

  <select id="countAll" resultType="int">
    select count(*) from ask
  </select>
  
  <!--일반회원 1:1 문의 목록 -->
  <select id="findAll" resultMap="askMap">
    select 
      a.ask_no,
      a.name,
      a.register_date,
      m.name,
      m.member_type_no,
      a.answer_check

    from 
      member m 
      inner join ask a on m.member_no=a.member_no
    order by 
      ask_no desc
  </select>
  
  
  <!-- 1:1 문의 등록 //  -->
  <insert id="insert" parameterType="ask">
    insert into ask(member_no,name,register_date,ask_content,answer_check) 
    values(#{memberNo},#{name},#{registerDate},#{askContent},#{answerCheck})
  </insert>

  <!--일반회원 1:1 문의상세 -->
  <select id="findByNo" resultMap="askMap" parameterType="int"> 
    select 
      ask_no,
      member_no,
      register_date,
      name
      ask_content,
      answer_content,
      answer_date,
      answer_check
    from 
      ask
    where 
      ask_no=#{no}
  </select>
  
  <!-- 1:1 문의 답변 -->
  <update id="update" parameterType="ask">
    update ask set 
      answer_content=#{answerContent},
      answer_date=#{answerDate},
      answer_check=true
    where 
      ask_no=#{no}
  </update>
  

 <!--  1:1 문의 삭제 -->
  <delete id="delete" parameterType="int">
    delete from ask
    where ask_no=#{no}
  </delete>


</mapper>


